a---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data

### Initializations

Make some initial environmental settings for the script. This makes sure we have needed libraries loaded and key script variables set. Specifically, we expect the data to be in our working directory. The same directory from which our R script is running. That needs to be set.  When running this script on your computer, set the *working_dir* variable accordingly, so that you can reproduce the output. It is the only thing that needs to be changed.

```{r}

# set working_dir variable
working_dir <- "~/Documents/courses/repdata/RepData_PeerAssessment1"

# set working directory
setwd(working_dir)
```

### Load the data

```{r results='hide'}

# read the data
activity <- read.csv("activity.csv") 

```


### Preprocess the data

In order to produce histogram and calculate the mean and median, we first compute the sum of steps for each day. 

```{r}

# get dailySteps by day
dailySteps <- aggregate(steps ~ date, activity, sum)
meanSteps <- as.integer(mean(dailySteps$steps))
medianSteps <- as.integer(median(dailySteps$steps))

# get interval steps by day
dailyAvg <- aggregate(steps ~ interval, activity, mean)
```

## What is mean total number of steps taken per day?

* The historgam of the total number of step taken.

```{r}
hist(dailySteps$steps, breaks=seq(0,25000,1000), col="BLUE")
```

* The **mean** and **median** of total number of steps taken per day.
    * Mean: `r meanSteps`
    * Median: `r medianSteps`
  
## What is the average daily activity pattern?

* Below is a time series plot of the 5-minute intervals and the average number of steps taken, averaged across all days.


```{r}
plot(dailyAvg$interval,
     dailyAvg$steps,
     type = "l",
     xlab = "5 Minute Intervals",
     ylab = "Average Steps Taken",
     panel.first = grid()
)
axis(side=1, at = seq(0,2500,250))
```


```{r}
max_interval <- dailyAvg[which(dailyAvg$steps == max(dailyAvg$steps)),]$interval
```

* The interval which contains the maximum average, across all days in the dataset, is $`r max_interval`$


## Imputing missing values

```{r}
# get count of the total number NA values
total_na <- length(activity[which(is.na(activity$steps)),]$steps)

# replace missing values with corresponding mean of the interval
missing <- which(is.na(activity$steps))
i_mean <- aggregate(steps ~ interval, activity, mean)
for (r in missing) {
  activity$steps[r] <- i_mean$steps[i_mean$interval == activity$interval[r]]
}

# get dailySteps by day
dailySteps <- aggregate(steps ~ date, activity, sum)
meanSteps <- as.integer(mean(dailySteps$steps))
medianSteps <- as.integer(median(dailySteps$steps))

# get interval steps by day
dailyAvg <- aggregate(steps ~ interval, activity, mean)
```

* The historgam of the total number of step taken.

```{r}
hist(dailySteps$steps, breaks=seq(0,25000,1000), col="BLUE")
```

* Total number of missing values is $`r total_na`$

* The **mean** and **median** of total number of steps taken per day.
    * Mean: $`r meanSteps`$
    * Median: $`r medianSteps`$

## Are there differences in activity patterns between weekdays and weekends?

